<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Paws Pet House</title>
    <link rel="stylesheet" href="QLLH_KH.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
  </head>
  <body>
    <!-- Header ngang tr√™n c√πng -->
    <header class="site-header">
      <div class="logo">
        <img src="/G·ªôp/·∫¢nh/logo.png" alt="Paw Logo" class="logo-icon" />
        PAWS PET HOUSE
      </div>
      <div class="account">
        <img
          src="https://cdn-icons-png.flaticon.com/512/147/147144.png"
          alt="Avatar"
          class="avatar"
        />
        <span>Pecute</span>
      </div>
    </header>

    <!-- Chia 2 c·ªôt: sidebar + n·ªôi dung -->
    <div class="app-container">
      <!-- Sidebar -->
      <aside class="sidebar">
        <nav class="nav-menu">
          <a class="active" href="#"
            ><i class="fas fa-calendar-alt"></i> Qu·∫£n l√Ω l·ªãch h·∫πn</a
          >
          <a href="QLTTCN.html"
            ><i class="fas fa-chart-bar"></i> Qu·∫£n l√Ω th√¥ng tin c√° nh√¢n</a
          >
        </nav>
      </aside>

      <!-- N·ªôi dung ph·∫£i -->
      <div class="content-area">
        <!-- BREADCRUMB -->
        <div class="topbar">
          <span class="breadcrumb"
            >Trang ch·ªß / <strong>Qu·∫£n l√Ω l·ªãch h·∫πn</strong></span
          >
        </div>

        <!-- QU·∫¢N L√ù L·ªäCH H·∫∏N -->
        <div class="table-container">
          <div class="appointments-header">
            <h3 class="table-title">DANH S√ÅCH L·ªäCH H·∫∏N</h3>
            <button class="btn-primary" onclick="openBookingModal()">
              ƒê·∫∑t l·ªãch m·ªõi
            </button>
          </div>

          <!-- Danh s√°ch l·ªãch h·∫πn -->
          <div class="appointments-list">
            <div class="appointment-card">
              <button
                class="btn-edit"
                onclick="openEditModal()"
                title="Ch·ªânh s·ª≠a l·ªãch h·∫πn"
              >
                ‚úèÔ∏è
              </button>
              <h3 class="card-title">T·∫Øm r·ª≠a</h3>
              <div class="appointment-detail">
                <span>üêæ <strong class="card-pet">B√°nh bao</strong></span>
              </div>
              <div class="appointment-detail">
                <span>üïí <span class="card-time">10:00</span></span>
              </div>
              <div class="appointment-detail">
                <span>üìÖ <span class="card-date"> 2025-05-15</span></span>
              </div>
              <hr />
              <button class="btn-cancel" onclick="openCancelPopup(this)">H·ª¶Y L·ªäCH H·∫∏N</button>
            </div>
          </div>

          <!-- Modal ƒë·∫∑t l·ªãch -->
          <div id="bookingModal" class="modal">
            <div class="modal-content">
              <span class="close-btn" onclick="closeBookingModal()"
                >&times;</span
              >
              <h2>ƒê·∫∑t l·ªãch m·ªõi</h2>
              <br />
              <form class="booking-form">
                <!-- C√°c input b·∫°n ƒë√£ c√≥ -->
                <label for="pet">Ch·ªçn th√∫ c∆∞ng:</label>
                <select id="pet" required>
                  <option value="" disabled selected hidden>
                    -- Ch·ªçn th√∫ c∆∞ng --
                  </option>
                  <option value="banhbao">B√°nh bao</option>
                  <option value="new" style="color: #880e4f">
                    Th√™m m·ªõi...
                  </option>
                </select>

                <label for="service">Lo·∫°i d·ªãch v·ª•:</label>
                <select id="service" required>
                  <option value="" disabled selected hidden>
                    -- Ch·ªçn d·ªãch v·ª• --
                  </option>
                  <option value="tamrua">T·∫Øm r·ª≠a</option>
                  <option value="kham">Kh√°m s·ª©c kh·ªèe</option>
                </select>

                <label for="date">Ch·ªçn ng√†y:</label>
                <input type="date" id="date" required />

                <label for="time">Khung gi·ªù:</label>
                <select id="time" required>
                  <option value="" disabled selected hidden>
                    -- Ch·ªçn khung gi·ªù --
                  </option>
                  <option value="08:00">08:00</option>
                  <option value="10:00">10:00</option>
                  <option value="14:00">14:00</option>
                  <option value="16:00">16:00</option>
                </select>

                <button
                  type="button"
                  class="btn-primary"
                  onclick="openPaymentMethodModal()"
                >
                  Thanh to√°n
                </button>
              </form>
            </div>
          </div>
          <!-- POP-UP H·ª¶Y L·ªäCH H·∫∏N -->
          <div id="cancelAppointmentPopup" class="popup-overlay">
            <div class="popup-box">
              <div class="popup-header">H·ª¶Y L·ªäCH H·∫∏N</div>
              <div class="popup-body">
                <div class="popup-content">
                  <img src="https://png.pngtree.com/png-vector/20230314/ourmid/pngtree-hazard-icon-vector-png-image_6647993.png" class="warning-icon" alt="Warning">
                  <p>B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën h·ªßy l·ªãch h·∫πn ƒë√£ ch·ªçn?</p>
                </div>
                <div class="popup-actions">
                  <button class="btn btn-confirm" onclick="confirmCancellation()">X√°c nh·∫≠n</button>
                  <button class="btn btn-cancel" onclick="closeCancelPopup()">Quay l·∫°i</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Modal ch·ªçn ph∆∞∆°ng th·ª©c thanh to√°n -->
          <div id="PaymentMethodModal" class="modal">
            <div class="modal-content">
              <h3>Ch·ªçn ph∆∞∆°ng th·ª©c thanh to√°n</h3>
              <button onclick="selectPayment('cash')">üíµ Ti·ªÅn m·∫∑t</button>
              <button onclick="selectPayment('momo')">üì± QR MoMo</button>
              <button onclick="selectPayment('bank')">üè¶ QR Ng√¢n h√†ng</button>
              <button
                onclick="closePaymentMethodModal()"
                style="background-color: #949494"
              >
                H·ªßy
              </button>
            </div>
          </div>

          <!-- Modal x√°c nh·∫≠n thanh to√°n -->
          <div id="confirmModal" class="modal">
            <div class="modal-content">
              <span class="close-btn" onclick="closeConfirmModal()"
                >&times;</span
              >
              <h3>X√°c nh·∫≠n ƒë·∫∑t l·ªãch</h3>
              <p><strong>Th√∫ c∆∞ng:</strong> <span id="confirmPet"></span></p>
              <p><strong>D·ªãch v·ª•:</strong> <span id="confirmService"></span></p>
              <p>
                <strong>Th·ªùi gian:</strong> <span id="confirmDateTime"></span>
              </p>

              <div
                id="qrSection"
                style="display: none; text-align: center; margin: 20px 0"
              >
                <img
                  id="qrImage"
                  src=""
                  alt="QR Code"
                  style="max-width: 200px"
                />
                <p>Vui l√≤ng qu√©t m√£ ƒë·ªÉ thanh to√°n</p>
              </div>

              <button onclick="submitConfirmModal()">X√°c nh·∫≠n</button>
            </div>
          </div>

          <!-- Modal ƒë·∫∑t l·ªãch th√†nh c√¥ng -->
          <div id="successModal" class="modal">
            <div class="modal-content">
              <h3>üéâ ƒê·∫∑t l·ªãch th√†nh c√¥ng!</h3>
              <br />
              <p>C·∫£m ∆°n b·∫°n ƒë√£ ƒë·∫∑t l·ªãch t·∫°i PAWS PET HOUSE.</p>
              <button onclick="closeSuccessModal()">ƒê√≥ng</button>
            </div>
          </div>

          <!-- Modal ch·ªânh s·ª≠a l·ªãch h·∫πn -->
          <div id="editModal" class="modal">
            <div class="modal-content">
              <span class="close-btn" onclick="closeEditModal()">&times;</span>
              <h2>Ch·ªânh s·ª≠a l·ªãch h·∫πn</h2>
              <br />
              <form class="booking-form edit-mode">
                <label for="editPet">Ch·ªçn th√∫ c∆∞ng:</label>
                <select id="editPet" required>
                  <option value="" disabled selected hidden>
                    -- Ch·ªçn th√∫ c∆∞ng --
                  </option>
                  <option value="banhbao">B√°nh bao</option>
                  <option value="new" style="color: #880e4f">
                    Th√™m m·ªõi...
                  </option>
                </select>

                <label for="editService">Lo·∫°i d·ªãch v·ª•:</label>
                <select id="editService" required>
                  <option value="" disabled selected hidden>
                    -- Ch·ªçn d·ªãch v·ª• --
                  </option>
                  <option value="tamrua">T·∫Øm r·ª≠a</option>
                  <option value="kham">Kh√°m s·ª©c kh·ªèe</option>
                </select>

                <label for="editDate">Ch·ªçn ng√†y:</label>
                <input type="date" id="editDate" required />

                <label for="editTime">Khung gi·ªù:</label>
                <select id="editTime" required>
                  <option value="" disabled selected hidden>
                    -- Ch·ªçn khung gi·ªù --
                  </option>
                  <option value="08:00">08:00</option>
                  <option value="10:00">10:00</option>
                  <option value="14:00">14:00</option>
                  <option value="16:00">16:00</option>
                </select>

                <button
                  type="button"
                  class="btn-primary"
                  onclick="submitEditModal()"
                >
                  L∆∞u thay ƒë·ªïi
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // X·ª≠ l√Ω lu·ªìng modal ƒê·∫∑t l·ªãch m·ªõi
      function openBookingModal() {
        document.getElementById("bookingModal").style.display = "flex";
      }

      function closeBookingModal() {
        document.getElementById("bookingModal").style.display = "none";
      }

      // X·ª≠ l√Ω lu·ªìng Thanh to√°n
      function openPaymentMethodModal() {
        document.getElementById("PaymentMethodModal").style.display = "flex";
      }

      function closePaymentMethodModal() {
        document.getElementById("PaymentMethodModal").style.display = "none";
      }

      function closeConfirmModal() {
        document.getElementById("confirmModal").style.display = "none";
        document.getElementById("PaymentMethodModal").style.display = "flex";
      }

      function selectPayment(method) {
        document.getElementById("PaymentMethodModal").style.display = "none"; // ·∫©n modal ch·ªçn pttt
        // L·∫•y th√¥ng tin ƒë·∫∑t l·ªãch ·ªü modal booking
        const pet =
          document.getElementById("pet").options[
            document.getElementById("pet").selectedIndex
          ].text;
        const service =
          document.getElementById("service").options[
            document.getElementById("service").selectedIndex
          ].text;
        const date = document.getElementById("date").value;
        const time = document.getElementById("time").value;

        // ƒê·ªï th√¥ng tin ƒë·∫∑t l·ªãch v√†o modal confirm
        document.getElementById("confirmPet").innerText = pet;
        document.getElementById("confirmService").innerText = service;
        document.getElementById(
          "confirmDateTime"
        ).innerText = `${date} - ${time}`;

        // Hi·ªÉn th·ªã QR code
        const qrSection = document.getElementById("qrSection");
        const qrImage = document.getElementById("qrImage");

        if (method === "cash") {
          qrSection.style.display = "none";
        } else {
          qrSection.style.display = "block";
          qrImage.src =
            method === "momo"
              ? "https://upload.wikimedia.org/wikipedia/vi/f/fe/MoMo_Logo.png" // demo QR
              : "https://upload.wikimedia.org/wikipedia/commons/thumb/3/36/Vietcombank_logo.svg/2560px-Vietcombank_logo.svg.png"; // demo QR
        }

        document.getElementById("confirmModal").style.display = "flex";
      }

      function submitConfirmModal() {
        // ·∫®n modal x√°c nh·∫≠n
        document.getElementById("confirmModal").style.display = "none";

        // Hi·ªán modal th√†nh c√¥ng
        document.getElementById("successModal").style.display = "flex";
      }

      function closeSuccessModal() {
        document.getElementById("successModal").style.display = "none";
        closeBookingModal();
        // Reset form n·∫øu c·∫ßn:
        document.querySelector(".booking-form").reset();
      }

      function openEditModal() {
        // Gi·∫£ l·∫≠p l·∫•y d·ªØ li·ªáu l·ªãch h·∫πn c·∫ßn ch·ªânh s·ª≠a (·ªü th·ª±c t·∫ø b·∫°n c√≥ th·ªÉ truy·ªÅn v√†o ho·∫∑c l·∫•y t·ª´ DOM)
        document.getElementById("editPet").value = "banhbao";
        document.getElementById("editService").value = "tamrua";
        document.getElementById("editDate").value = "2025-05-15";
        document.getElementById("editTime").value = "10:00";

        document.getElementById("editModal").style.display = "flex";
      }

      function closeEditModal() {
        document.getElementById("editModal").style.display = "none";
      }

      function submitEditModal() {
        // TODO: l∆∞u d·ªØ li·ªáu ch·ªânh s·ª≠a n·∫øu c·∫ßn
        alert("üéâ C·∫≠p nh·∫≠t l·ªãch h·∫πn th√†nh c√¥ng!");
        closeEditModal();
      }
      // X·ª¨ L√ù POPUP H·ª¶Y L·ªäCH H·∫∏N
      const cancelPopup = document.getElementById('cancelAppointmentPopup');
      let cardToDelete = null; 

      function openCancelPopup(button) {
        // T√¨m th·∫ª cha .appointment-card g·∫ßn nh·∫•t v√† l∆∞u v√†o bi·∫øn t·∫°m
        cardToDelete = button.closest('.appointment-card');
        cancelPopup.style.display = 'flex';
      }

      function closeCancelPopup() {
        cancelPopup.style.display = 'none';
        cardToDelete = null; // Reset bi·∫øn t·∫°m khi ƒë√≥ng popup
      }

      function confirmCancellation() {
        if (cardToDelete) {
          cardToDelete.remove(); // X√≥a th·∫ª kh·ªèi giao di·ªán
          alert('ƒê√£ h·ªßy l·ªãch h·∫πn th√†nh c√¥ng!');
        }
        closeCancelPopup(); // ƒê√≥ng popup sau khi x·ª≠ l√Ω
      }
    </script>
  </body>
</html>
